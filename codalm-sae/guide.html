<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Guide - CodaLM-SAE</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      color: #222;
      background: #fff;
      line-height: 1.65;
      -webkit-font-smoothing: antialiased;
    }
    .page {
      max-width: 600px;
      margin: 0 auto;
      padding: 40px 20px 80px;
    }
    a { color: #222; }
    a:hover { color: #000; }
    .back {
      font-size: 0.82em;
      color: #999;
      text-decoration: none;
      display: inline-block;
      margin-bottom: 2em;
    }
    .back:hover { color: #222; }
    h1 {
      font-family: "Times New Roman", Georgia, serif;
      font-size: 1.6em;
      font-weight: normal;
      margin-bottom: 0.2em;
    }
    .lead {
      font-size: 0.95em;
      color: #555;
      margin-bottom: 2em;
    }
    .links {
      display: flex;
      gap: 0.8em;
      margin-bottom: 2.5em;
      flex-wrap: wrap;
    }
    .links a {
      padding: 0.35em 0.85em;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-size: 0.82em;
      color: #555;
      text-decoration: none;
    }
    .links a:hover { border-color: #999; color: #222; }
    h2 {
      font-size: 0.82em;
      font-weight: 600;
      color: #999;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      margin: 2.5em 0 0.8em;
    }
    h2:first-of-type { margin-top: 0; }
    p { font-size: 0.9em; margin-bottom: 0.8em; }
    .b { font-weight: 600; color: #111; }
    .mono {
      font-family: "SF Mono", "Fira Code", monospace;
      font-size: 0.85em;
      background: #f5f5f5;
      padding: 0.15em 0.4em;
      border-radius: 3px;
    }
    .diagram {
      font-family: "SF Mono", "Fira Code", monospace;
      font-size: 0.8em;
      line-height: 1.7;
      background: #f8f9fa;
      border: 1px solid #eee;
      padding: 0.9em 1.1em;
      border-radius: 6px;
      color: #444;
      margin: 0.6em 0 1.2em;
      overflow-x: auto;
    }
    dl {
      margin: 0.3em 0 1em;
    }
    dt {
      font-size: 0.88em;
      font-weight: 600;
      color: #111;
      margin-top: 0.8em;
    }
    dd {
      font-size: 0.85em;
      color: #555;
      margin: 0.15em 0 0 0;
    }
    .keys {
      display: grid;
      grid-template-columns: auto 1fr;
      gap: 0.25em 0.8em;
      font-size: 0.85em;
      color: #555;
    }
    kbd {
      display: inline-block;
      padding: 1px 6px;
      background: #f3f4f6;
      border: 1px solid #d1d5db;
      border-radius: 3px;
      font-family: inherit;
      font-size: 0.9em;
    }
    hr {
      border: none;
      border-top: 1px solid #eee;
      margin: 2.5em 0;
    }
    footer {
      font-size: 0.8em;
      color: #bbb;
      text-align: center;
    }
    footer a { color: #bbb; text-decoration: none; }
    footer a:hover { color: #666; }
  </style>
</head>
<body>
<div class="page">
  <a href="index.html" class="back">&larr; Explorer</a>

  <h1>CodaLM-SAE Guide</h1>
  <p class="lead">How we built this and how to read it.</p>

  <div class="links">
    <a href="#">Read the paper</a>
    <a href="https://github.com/garrettallen14/codalm-sae">Code repository</a>
    <a href="index.html">Feature explorer</a>
    <a href="codas.html">Coda types</a>
  </div>

  <h2>What we did</h2>
  <p>Sperm whales communicate with codas: short bursts of clicks with specific timing patterns. Whales self-sort into vocal clans based on shared coda dialects. We wanted to understand what a language model learns about these dialects internally.</p>
  <p>We trained a small transformer (<span class="b">CodaLM</span>) on Pacific coda sequences to predict the next coda in a sequence. Then we applied a <span class="b">sparse autoencoder</span> (SAE) to decompose the model's internal representations into individual, interpretable features.</p>
  <p>The SAE discovered features that encode clan identity without the model ever seeing clan labels. Injecting a single feature's direction back into the model causally steers its predictions to the target clan.</p>

  <h2>Pipeline</h2>
  <div class="diagram">Coda sequences (32 per window)
  &darr;
CodaLM (4 layers, 4 heads, d=128, ~800K params)
  &darr;  hidden states (128-dim)
TopK SAE (k=12, 512 features)
  &darr;  sparse activations
191 alive features &rarr; this explorer</div>

  <p>The SAE encoder maps each 128-dimensional hidden state to 512 features, with only 12 active at a time. Of the 512, 191 fire on at least 1% of windows. The rest are dead. This explorer shows only the alive features.</p>

  <h2>Data</h2>
  <p>23,555 codas from the Pacific Ocean (Hersh et al., 2022), spanning 7 vocal clans recorded at 23 locations between 1978 and 2017. Each coda is represented by its inter-click interval (ICI) vector. We slide 32-coda windows across recording sessions with stride 16, yielding 1,131 windows.</p>

  <h2>How to read the explorer</h2>

  <dl>
    <dt>Sidebar</dt>
    <dd>All 191 alive features. Each row shows the feature index, dominant clan (colored dot), type badge, firing rate, and selectivity score. Click to view details. Search by index, clan, or coda type.</dd>

    <dt>Selectivity</dt>
    <dd>How concentrated a feature's activation is across clans. 1.0 = fires for only one clan. ~0.14 = fires equally across all seven. The big number on each sidebar row.</dd>

    <dt>Clan activation bars</dt>
    <dd>Mean activation for each clan. Lopsided bars = clan-selective. Flat bars = shared pattern.</dd>

    <dt>Top activating windows</dt>
    <dd>Coda sequences where this feature fires strongest. Each colored chip is a coda type. Brighter = higher relevance to this feature, faded = less relevant. Click any chip to see that coda type's full page.</dd>

    <dt>Logit lens</dt>
    <dd>What this feature does to next-coda prediction. "Promotes" = pushes toward predicting these types next. "Suppresses" = pushes away. Click any type to see its detail page.</dd>

    <dt>Co-firing</dt>
    <dd>Features that activate on the same windows. High percentage = they encode related patterns. Click to jump to that feature.</dd>

    <dt>Histogram</dt>
    <dd>Distribution of activation strengths when the feature fires. Tight peak = consistent. Long tail = graded response.</dd>
  </dl>

  <h2>Feature types</h2>
  <p><span class="b">Clan-specific</span> features fire primarily for one or two clans. These encode cultural vocal patterns.</p>
  <p><span class="b">Universal</span> features fire across all clans. These encode structural or sequential patterns common to all whales.</p>
  <p><span class="b">Intermediate</span> features are in between: shared by some clans but not others.</p>

  <h2>Keyboard</h2>
  <div class="keys">
    <span><kbd>&uarr;</kbd> <kbd>&darr;</kbd></span> <span>Browse features</span>
    <span><kbd>j</kbd> <kbd>k</kbd></span> <span>Same (vim-style)</span>
  </div>

  <hr>
  <footer>
    <a href="index.html">Explorer</a> &middot; <a href="codas.html">Coda types</a> &middot; <a href="https://github.com/garrettallen14/codalm-sae">GitHub</a>
  </footer>
</div>
</body>
</html>
